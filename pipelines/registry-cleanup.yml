## Cleanup job for the registries

registry_cleanup:
  stage: SystemMaintenance
  needs: []
  image: invent-registry.kde.org/sysadmin/ci-images/suse-qt515:latest
  rules:
    - when: manual
    - if: '$CI_PIPELINE_SOURCE == "schedule"'
  tags:
    - Linux
  variables:
    KDECI_CACHE_PATH: /mnt/artifacts/suse-qt5.15/
    KDECI_GITLAB_SERVER: https://invent.kde.org/
  before_script:
    - git clone https://invent.kde.org/dkazakov/ci-utilities.git
    - git clone https://invent.kde.org/dkazakov/krita-deps-repo-metadata.git ci-utilities/repo-metadata/
  script:
    - python3 -u ci-utilities/package-registry-cleanup.py --project dkazakov/krita-ci-artifacts-windows-qt5.15
    - python3 -u ci-utilities/package-registry-cleanup.py --project dkazakov/krita-ci-artifacts-appimage-qt5.15
